# SOCRadar Incident Connector for Microsoft Sentinel (Webhook) üõ°Ô∏è

This Azure Logic App solution automates the integration of security events from the **SOCRadar** threat intelligence platform, creating native **Incidents** directly inside your Microsoft Sentinel workspace. This workflow uses an **HTTP Webhook trigger**, enabling **real-time push notifications** whenever a new alert is generated by SOCRadar.

## üöÄ Quick Deployment

Click the **Deploy to Azure** button below to deploy the Logic App, its necessary API Connection, and configure all parameters in a single step via the Azure Portal.

[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https://raw.githubusercontent.com/Radargoger/socradar-sentinel-alarm-connector-api/refs/heads/main/template.json)

## ‚öôÔ∏è Solution Architecture & Functionality

This Consumption Logic App uses an **HTTP Request trigger** to act as a Webhook, allowing SOCRadar to push a JSON payload containing an alert immediately when an incident occurs.

| Component | Function | Notes |
| :--- | :--- | :--- |
| **HTTP Request Trigger** | Receives the real-time JSON payload (Webhook). | The schema is configured to handle **null values** gracefully. |
| **For Each** | Processes each alert within the received payload's `data` array. | Iterates over `@triggerBody()?['data']`. |
| **Create Incident** | Creates a Sentinel Incident for each alert using the Managed Connector. | Maps SOCRadar fields to Sentinel Incident fields. |

### Field Mapping (with Null Protection)

The Logic App's schema is robust, preventing failures if an optional SOCRadar field is `null`:

| SOCRadar Field | Microsoft Sentinel Incident Field | Safe Type in Schema |
| :--- | :--- | :--- |
| `alarm_type_details.alarm_generic_title` + `alarm_id` | **Title** | `string` and `integer` (with `null`) |
| `alarm_risk_level` | **Severity** | `string` (with `null`) |
| `alarm_text` | **Description** | `string` (with `null`) |

## üìù Prerequisites & Deployment Parameters

You will need the following information to successfully deploy the ARM template:

| Parameter Name | Description | Default Value |
| :--- | :--- | :--- |
| **Logic App Name** | The name for the Logic App resource. | `SOCRadar-Sentinel-Webhook-LA` |
| **Location** | The Azure region for deployment. | `[resourceGroup().location]` |
| **Sentinel Connection Name** | The resource name for the Azure Sentinel API connection. | `azuresentinel-webhook-1` |
| **Sentinel Workspace Path** | **The full path to your Sentinel Workspace.** **(CRITICAL)** This is used in the `path` field of the Create Incident action. | `/Incidents/subscriptions/ID/resourceGroups/RG/workspaces/WS_NAME` **(UPDATE THIS)** |


## üõ†Ô∏è Post-Deployment Configuration (CRITICAL MANUAL STEPS)

The Logic App will not function correctly until these two manual steps are completed:

### 1. Authorize the API Connection

The managed connection needs permissions to write incidents to Sentinel.

* Navigate to the deployed **API Connection resource** (e.g., `azuresentinel-webhook-1`).
* Go to **Edit API Connection** and click the **Authorize** button.
* Sign in with an Azure identity that has the **Microsoft Sentinel Contributor** role on the target workspace.

### 2. Retrieve and Configure the Webhook URL

This is the unique endpoint for SOCRadar to send alerts to.

* Navigate to the deployed **Logic App resource**.
* Open the **Logic App Designer**.
* Click on the **HTTP Request Trigger** and **copy the generated HTTP POST URL**.
* **Configure SOCRadar:** Use the copied Webhook URL to configure the alert forwarding mechanism in the SOCRadar platform.

## üîé Viewing the Incidents

New SOCRadar alerts received via the Webhook will automatically appear in:

* **Microsoft Sentinel** ‚Üí **Incidents** blade.

## üõë Troubleshooting

| Problem | Possible Solution |
| :--- | :--- |
| **Logic App Run Fails (401/403 Error).** | You must complete **Step 1: Authorize the API Connection**. The connection lacks permissions to the Sentinel workspace. |
| **Logic App Fails in For Each.** | SOCRadar might be sending a payload that does not contain a `data` array or the array is empty. Check the trigger's raw output. |
| **Sentinel Workspace Path Error.** | Verify the **Sentinel Workspace Path** parameter is exactly correct (Subscription ID, Resource Group, and Workspace Name). |
